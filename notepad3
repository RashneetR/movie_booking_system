user.rb

 # frozen_string_literal: true

class UserMailer < ApplicationMailer
  default from: 'rashneetforsampleapp@gmail.com'

  def welcome_email(user)
    puts "\n\n\n\n\n hi hi #{user} hi hi \n\n\n\n"
    puts "\n\n\n\n\n hi hi #{user.id} hi hi \n\n\n\n"
    @user = User.find_by(id: user.id)
    #@user = User.find_by(id: params[:user][:id])
    #@user = params[:user]
    mail(to: @user.email, subject: 'Welcome to BookMyShow')
  end

  def movie_update
    # @subscriptions = params[:subscription]
    @users = params[:user]
    @movie_name = params[:movie_name]
    @users.each do |user_id|
      @user = User.find(user_id)
      mail(to: @user.email, subject: 'Movie release!')
    end
  end

  def ticket_booked
    @ticket = params[:ticket]
    mail(to: @ticket.user.email, subject: 'Tickets Confirmed')
  end

  def sample_email
    puts 'Hello1 '
    @user = User.find(params[:user][:id])
    puts "\n\n\n\n\n #{@user}\n\n\n"
    mail(to: @user.email, subject: 'Sample Email')
    puts 'Hello3 '
  end
end


////////////////////////////////////////
class MovieObserver < Mongoid::Observer
  def before_destroy(admin_movie)
    return true if admin_movie.shows.blank? && admin_movie.reviews.blank?

    #admin_theatre.errors.add(:base, "Cannot delete theatre due to existing shows for the theatre")
    throw(:abort)
  end

  def after_destroy(admin_movie)
    @subscriptions = MovieInterest.where(movie_id: admin_movie.id)
    @subscriptions.each(&:destroy)
  end
end


class ShowObserver < Mongoid::Observer
  def before_destroy(admin_show)
    return true if admin_show.tickets.blank?

    #admin_theatre.errors.add(:base, "Cannot delete theatre due to existing shows for the theatre")
    throw(:abort)
  end
  


end



class TheatreObserver < Mongoid::Observer

  def before_destroy(admin_theatre)
    byebug
    return true if admin_theatre.shows.blank?

    admin_theatre.errors.add(:base, "Cannot delete theatre due to existing shows for the theatre")
    throw(:abort)
  end
end



===

sign_in @ser

sesison .clear

def cancel

end


def active_for_authentication?
     return true if super && self.active == "active"
     if super && self.active == "inactive"
      errors.add(:active,'Account is inactive. Please click on confirm account to activate')
    end

  end



        #@admin_movies.map! do |admin_movie|
      #@movie = Movie.find_by(id: admin_movie["_id"])
      #admin_movie["_id"] = @movie.name
      #puts "\nexcuse me #{admin_movie["_id"]}\n\n"
    #end


    , controllers: { sessions: 'mydevise/sessions'}

home.html.erb
    <%= link_to 'Sign Up', new_user_registration_path, class: 'btn btn-primary btn-sm' %>


    def new
    super
  end
  # POST /my_devise/sessions
  # POST /my_devise/sessions.json
  def create
    super
    if @user.active == "inactive"
      puts "\n\n\n\ninactive bro\n\n\n\n\n"
      sign_out @user
      redirect_to static_pages_home_path, notice: 'Account Exists. Activate account?'
    else
    redirect_to movies_path, notice: 'User signed in'
    end
  end

  def destroy
    super
  end